(function(){this.Autocomplete=function(){function b(b){this.fields=b;this.inserted=[];this.observe(this.fields.input)}b.prototype.observe=function(b){var d;d=this;return b.observe_field(1,function(){return d.query(this.value)})};b.prototype.query=function(b){var d;d=this;return b.length>0&&b!=="Asprin, Valium, Zanax..."?$.ajax({url:"/autocomplete/"+b,contentType:"application/json",type:"GET",success:function(c){return _.each(c,function(a){if(_.indexOf(d.inserted,a.id)===-1)return dust.render("autocomplete_result",
a,function(c,b){d.fields.results.append(b);return d.inserted.push(a.id)})})}}):this.fields.results.html("")};return b}()}).call(this);this.DocuMeds={Url:null,Views:{},Controllers:{},Collections:{},Models:{},Functions:{},init:function(){Backbone.history.start();DocuMeds.Controllers.Items.index();return!1}};$(function(){DocuMeds.init();DocuMeds.Functions.applyDefaultText("autocomplete","Asprin, Valium, Zanax...");return new Autocomplete({input:$("#autocomplete"),results:$("#resultsList")})});
(function(){var b,e,d=Object.prototype.hasOwnProperty,c=function(a,c){function b(){this.constructor=a}for(var e in c)d.call(c,e)&&(a[e]=c[e]);b.prototype=c.prototype;a.prototype=new b;a.__super__=c.prototype;return a};b=function(){function a(){a.__super__.constructor.apply(this,arguments)}c(a,Backbone.Router);a.prototype.routes={items:"index","items/add/:id":"add"};a.prototype.index=function(){var a;return DocuMeds.Collections.Items.length===0?DocuMeds.Collections.Items.fetch({success:function(){return(new DocuMeds.Views.Items({collection:DocuMeds.Collections.Items,
el:$("#itemList")})).render()}}):(a=new DocuMeds.Views.Items({collection:DocuMeds.Collections.Items}),a.render())};a.prototype.add=function(a){return DocuMeds.Collections.Items.create({medication_id:a},{wait:!0})};return a}();DocuMeds.Controllers.Items=new b;b=function(){function a(){a.__super__.constructor.apply(this,arguments)}c(a,Backbone.Model);a.prototype.defaults={};a.prototype.name="item";a.prototype.url=function(){return"/items"};return a}();DocuMeds.Models.Item=b;b=function(){function a(){a.__super__.constructor.apply(this,
arguments)}c(a,Backbone.Collection);a.prototype.model=DocuMeds.Models.Item;a.prototype.url=function(){return"/items"};return a}();DocuMeds.Collections.Items=new b;e=function(){function a(){a.__super__.constructor.apply(this,arguments)}c(a,Backbone.View);a.prototype.initialize=function(){this.render=_.bind(this.render,this);return this.model.bind("change:name",this.render)};a.prototype.render=function(){var a;a=this;dust.render("items_row",this.model.toJSON(),function(c,b){return a.el=b});return this};
return a}();b=function(){function a(){a.__super__.constructor.apply(this,arguments)}c(a,Backbone.View);a.prototype.initialize=function(){_(this).bindAll("add","remove");this._itemViews=[];this.collection.each(this.add);this.collection.bind("add",this.add);return this.collection.bind("remove",this.remove)};a.prototype.add=function(a){a=new e({model:a});this._itemViews.push(a);if(this._rendered)return $(this.el).append(a.render().el)};a.prototype.remove=function(a){var c;c=_(this._itemViews).select(function(){return cv.model===
a})[0];this._itemViews=_(this._itemViews).without(c);if(this._rendered)return $(c.el).remove()};a.prototype.render=function(){var a;a=this;this._rendered=!0;$(this.el).empty();_(this._itemViews).each(function(c){return $(a.el).append(c.render().el)});return this};return a}();DocuMeds.Views.Items=b}).call(this);
(function(){var b,e,d;DocuMeds.Functions.getUrlParameters=function(){return d({},b)};DocuMeds.Functions.getUrlParameter=function(c){return DocuMeds.Functions.getUrlParameters()[c]};DocuMeds.Functions.paramsContain=function(c){var a;a=d([],e);return _.include(a,c)};d=function(c,a){var b;b=window.location.href.slice(window.location.href.indexOf("?")+1).split("&");_.each(b,function(b){b=b.split("=");return a(c,b)});return c};DocuMeds.Functions.readCookie=function(c){var a,b,d;d=c+"=";a=document.cookie.split(";");
for(b=0;b<a.length;){for(c=a[b];c.charAt(0)===" ";)c=c.substring(1,c.length);if(c.indexOf(d)===0)return c.substring(d.length,c.length).replace(/"/g,"");b++}return a};DocuMeds.Functions.setCookie=function(c,a){var b;b=new Date("2015-01-01 12:00:00");return document.cookie=c+"="+escape(a)+";expires="+b.toGMTString()};e=function(c,a){return c.push(a[0])};b=function(c,a){return c[a[0]]=a[1]};DocuMeds.Functions.applyDefaultText=function(c,a){c=document.getElementById(c);if(c===null||c===void 0)return!1;
c.style.color="#9d9d9d";if(c.value==="")c.value=a;c.onfocus=function(){if(this.value===a)return this.value=this.style.color=""};return c.onblur=function(){if(this.value==="")return this.style.color="#9d9d9d",this.value=a}}}).call(this);(function(){function b(b,d){return b.write("<li>").reference(d.get("name"),d,"h").write("</li>")}dust.register("items_row",b);return b})();
(function(){function b(b,d){return b.write("<li><a href='/medication/show/").reference(d.get("id"),d,"h").write("'>").reference(d.get("name"),d,"h").write('</a> <a href="#items/add/').reference(d.get("id"),d,"h").write('">Add</a></li>')}dust.register("autocomplete_result",b);return b})();
